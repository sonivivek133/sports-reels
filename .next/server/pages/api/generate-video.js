"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/generate-video";
exports.ids = ["pages/api/generate-video"];
exports.modules = {

/***/ "@aws-sdk/client-s3":
/*!*************************************!*\
  !*** external "@aws-sdk/client-s3" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@aws-sdk/client-s3");

/***/ }),

/***/ "fluent-ffmpeg":
/*!********************************!*\
  !*** external "fluent-ffmpeg" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("fluent-ffmpeg");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-video&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cgenerate-video.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-video&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cgenerate-video.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_generate_video_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\generate-video.ts */ \"(api)/./src/pages/api/generate-video.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_generate_video_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_generate_video_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_generate_video_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_generate_video_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/generate-video\",\n        pathname: \"/api/generate-video\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_generate_video_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmdlbmVyYXRlLXZpZGVvJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGc3JjJTVDcGFnZXMlNUNhcGklNUNnZW5lcmF0ZS12aWRlby50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNpRTtBQUNqRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsNkRBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDZEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Nwb3J0cy1yZWVscy8/OGYyNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjXFxcXHBhZ2VzXFxcXGFwaVxcXFxnZW5lcmF0ZS12aWRlby50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dlbmVyYXRlLXZpZGVvXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ2VuZXJhdGUtdmlkZW9cIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-video&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cgenerate-video.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/errorHandler.ts":
/*!***************************************!*\
  !*** ./src/pages/api/errorHandler.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withErrorHandler: () => (/* binding */ withErrorHandler)\n/* harmony export */ });\nfunction withErrorHandler(handler) {\n    return async (req, res)=>{\n        try {\n            await handler(req, res);\n        } catch (error) {\n            console.error(\"API Error:\", error);\n            res.status(500).json({\n                error: \"Internal Server Error\",\n                message: error instanceof Error ? error.message : \"Unknown error\"\n            });\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL2Vycm9ySGFuZGxlci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBRU8sU0FBU0EsaUJBQ2RDLE9BQXFFO0lBRXJFLE9BQU8sT0FBT0MsS0FBcUJDO1FBQ2pDLElBQUk7WUFDRixNQUFNRixRQUFRQyxLQUFLQztRQUNyQixFQUFFLE9BQU9DLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLGNBQWNBO1lBQzVCRCxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUNuQkgsT0FBTztnQkFDUEksU0FBU0osaUJBQWlCSyxRQUFRTCxNQUFNSSxPQUFPLEdBQUc7WUFDcEQ7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zcG9ydHMtcmVlbHMvLi9zcmMvcGFnZXMvYXBpL2Vycm9ySGFuZGxlci50cz9hYmZiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRoRXJyb3JIYW5kbGVyKFxyXG4gIGhhbmRsZXI6IChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkgPT4gUHJvbWlzZTx2b2lkPlxyXG4pIHtcclxuICByZXR1cm4gYXN5bmMgKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBoYW5kbGVyKHJlcSwgcmVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgICBlcnJvcjogJ0ludGVybmFsIFNlcnZlciBFcnJvcicsXHJcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufSJdLCJuYW1lcyI6WyJ3aXRoRXJyb3JIYW5kbGVyIiwiaGFuZGxlciIsInJlcSIsInJlcyIsImVycm9yIiwiY29uc29sZSIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/errorHandler.ts\n");

/***/ }),

/***/ "(api)/./src/pages/api/generate-video.ts":
/*!*****************************************!*\
  !*** ./src/pages/api/generate-video.ts ***!
  \*****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/client-s3 */ \"@aws-sdk/client-s3\");\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fluent-ffmpeg */ \"fluent-ffmpeg\");\n/* harmony import */ var fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _errorHandler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./errorHandler */ \"(api)/./src/pages/api/errorHandler.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_4__]);\naxios__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\nconst writeFile = (0,util__WEBPACK_IMPORTED_MODULE_5__.promisify)((fs__WEBPACK_IMPORTED_MODULE_2___default().writeFile));\nconst readFile = (0,util__WEBPACK_IMPORTED_MODULE_5__.promisify)((fs__WEBPACK_IMPORTED_MODULE_2___default().readFile));\nconst unlink = (0,util__WEBPACK_IMPORTED_MODULE_5__.promisify)((fs__WEBPACK_IMPORTED_MODULE_2___default().unlink));\nconst s3 = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.S3Client({\n    region: process.env.AWS_REGION,\n    credentials: {\n        accessKeyId: process.env.AWS_ACCESS_KEY_ID,\n        secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY\n    }\n});\nconst bucketEndpoint = `https://${process.env.AWS_S3_BUCKET}.s3.${process.env.AWS_REGION}.amazonaws.com`;\nconst NBA_PLAYER_IDS = {\n    \"LeBron James\": 2544,\n    \"Stephen Curry\": 201939,\n    \"Kevin Durant\": 201142\n};\nconst config = {\n    api: {\n        bodyParser: {\n            sizeLimit: \"25mb\"\n        }\n    }\n};\nconst IMAGE_COUNT = 5; // Images per reel\nconst REEL_COUNT = 2; // Number of reels to generate\nconst IMAGE_DURATION = 2; // seconds per image\nasync function downloadImagesWithFallbacks(celebrity) {\n    const images = [];\n    const IMAGE_TOTAL = IMAGE_COUNT * REEL_COUNT;\n    // NBA CDN\n    if (NBA_PLAYER_IDS[celebrity]) {\n        try {\n            const nbaUrl = `https://cdn.nba.com/headshots/nba/latest/1040x760/${NBA_PLAYER_IDS[celebrity]}.png`;\n            const nbaImg = await axios__WEBPACK_IMPORTED_MODULE_4__[\"default\"].get(nbaUrl, {\n                responseType: \"arraybuffer\"\n            });\n            images.push(Buffer.from(nbaImg.data, \"binary\"));\n        } catch  {}\n    }\n    // Wikimedia Commons\n    try {\n        const wikiApi = `https://en.wikipedia.org/w/api.php?action=query&generator=images&titles=${encodeURIComponent(celebrity)}&gimlimit=10&prop=imageinfo&iiprop=url&format=json`;\n        const wikiResp = await axios__WEBPACK_IMPORTED_MODULE_4__[\"default\"].get(wikiApi);\n        const pages = wikiResp.data?.query?.pages || {};\n        for (const page of Object.values(pages)){\n            const url = page.imageinfo?.[0]?.url;\n            if (url && /\\.(jpg|jpeg|png)$/i.test(url)) {\n                try {\n                    const imgResp = await axios__WEBPACK_IMPORTED_MODULE_4__[\"default\"].get(url, {\n                        responseType: \"arraybuffer\"\n                    });\n                    images.push(Buffer.from(imgResp.data, \"binary\"));\n                    if (images.length >= IMAGE_TOTAL) break;\n                } catch  {}\n            }\n        }\n    } catch  {}\n    // Pexels API\n    if (process.env.PEXELS_API_KEY) {\n        try {\n            const pexelsUrl = `https://api.pexels.com/v1/search?query=${encodeURIComponent(celebrity)}&per_page=${IMAGE_TOTAL}`;\n            const pexelsResp = await axios__WEBPACK_IMPORTED_MODULE_4__[\"default\"].get(pexelsUrl, {\n                headers: {\n                    Authorization: process.env.PEXELS_API_KEY\n                },\n                responseType: \"json\"\n            });\n            if (pexelsResp.data.photos?.length > 0) {\n                for (const photo of pexelsResp.data.photos){\n                    const imageUrl = photo.src.large2x;\n                    try {\n                        const imgResp = await axios__WEBPACK_IMPORTED_MODULE_4__[\"default\"].get(imageUrl, {\n                            responseType: \"arraybuffer\"\n                        });\n                        images.push(Buffer.from(imgResp.data, \"binary\"));\n                        if (images.length >= IMAGE_TOTAL) break;\n                    } catch  {}\n                }\n            }\n        } catch  {}\n    }\n    // Unsplash fallback\n    const fallbackUrls = [\n        \"https://images.unsplash.com/photo-1546519638-68e109498ffc?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&h=1400&q=80\",\n        \"https://images.unsplash.com/photo-1517649763962-0c623066013b?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80\",\n        \"https://images.unsplash.com/photo-1464983953574-0892a716854b?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80\",\n        \"https://images.unsplash.com/photo-1505843273132-bc5a993635c4?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80\",\n        \"https://images.unsplash.com/photo-1517649763962-0c623066013b?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80\"\n    ];\n    let i = 0;\n    while(images.length < IMAGE_TOTAL){\n        try {\n            const url = fallbackUrls[i % fallbackUrls.length];\n            const imgResp = await axios__WEBPACK_IMPORTED_MODULE_4__[\"default\"].get(url, {\n                responseType: \"arraybuffer\"\n            });\n            images.push(Buffer.from(imgResp.data, \"binary\"));\n        } catch  {}\n        i++;\n    }\n    return images.slice(0, IMAGE_TOTAL);\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    const tempFiles = [];\n    try {\n        const { audioBuffer, celebrity, script } = req.body;\n        if (!audioBuffer || !celebrity || !script) {\n            return res.status(400).json({\n                error: \"Invalid input\"\n            });\n        }\n        // Convert audio data to Buffer\n        let audioData;\n        if (typeof audioBuffer === \"string\" && audioBuffer.startsWith(\"data:\")) {\n            const base64Data = audioBuffer.split(\"base64,\")[1];\n            if (!base64Data) return res.status(400).json({\n                error: \"Invalid Base64 audioBuffer format\"\n            });\n            audioData = Buffer.from(base64Data, \"base64\");\n        } else if (Array.isArray(audioBuffer)) {\n            try {\n                audioData = Buffer.from(new Uint8Array(audioBuffer));\n            } catch (error) {\n                return res.status(400).json({\n                    error: \"Invalid ArrayBuffer format\"\n                });\n            }\n        } else {\n            return res.status(400).json({\n                error: \"Invalid audio format: must be Base64 or ArrayBuffer\"\n            });\n        }\n        const sanitizedName = celebrity.replace(/[^a-z0-9]/gi, \"_\").toLowerCase();\n        const tempDir = path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"tmp\");\n        if (!fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(tempDir)) fs__WEBPACK_IMPORTED_MODULE_2___default().mkdirSync(tempDir);\n        const timestamp = Date.now();\n        // Download enough images for all reels\n        const allImages = await downloadImagesWithFallbacks(celebrity);\n        const reels = [];\n        for(let reelIdx = 0; reelIdx < REEL_COUNT; reelIdx++){\n            // Pick a different slice of images for each reel\n            const images = allImages.slice(reelIdx * IMAGE_COUNT, (reelIdx + 1) * IMAGE_COUNT);\n            while(images.length < IMAGE_COUNT)images.push(images[images.length - 1]);\n            // Save images\n            const imagePaths = [];\n            for(let i = 0; i < images.length; i++){\n                const imgPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(tempDir, `${sanitizedName}-reel${reelIdx}-img${i}-${timestamp}.jpg`);\n                await writeFile(imgPath, images[i]);\n                imagePaths.push(imgPath);\n                tempFiles.push(imgPath);\n            }\n            // Save audio file\n            const audioPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(tempDir, `${sanitizedName}-reel${reelIdx}-audio-${timestamp}.mp3`);\n            await writeFile(audioPath, audioData);\n            tempFiles.push(audioPath);\n            // Prepare ffmpeg input file list for slideshow\n            const ffmpegListPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(tempDir, `${sanitizedName}-reel${reelIdx}-ffmpeg-list-${timestamp}.txt`);\n            const ffmpegListContent = imagePaths.map((img)=>`file '${img.replace(/\\\\/g, \"/\")}'\\nduration ${IMAGE_DURATION}`).join(\"\\n\");\n            await writeFile(ffmpegListPath, ffmpegListContent + `\\nfile '${imagePaths[imagePaths.length - 1].replace(/\\\\/g, \"/\")}'\\n`);\n            tempFiles.push(ffmpegListPath);\n            // Output video path\n            const videoPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(tempDir, `${sanitizedName}-reel${reelIdx}-video-${timestamp}.mp4`);\n            tempFiles.push(videoPath);\n            // Generate slideshow video from images\n            await new Promise((resolve, reject)=>{\n                fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_1___default()().input(ffmpegListPath).inputOptions([\n                    \"-f concat\",\n                    \"-safe 0\"\n                ]).outputOptions([\n                    \"-vf scale=720:1280,format=yuv420p\",\n                    \"-pix_fmt yuv420p\",\n                    \"-r 30\"\n                ]).outputOptions(\"-y\").output(videoPath).on(\"end\", resolve).on(\"error\", reject).run();\n            });\n            // Merge audio with slideshow video\n            const finalVideoPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(tempDir, `${sanitizedName}-reel${reelIdx}-final-${timestamp}.mp4`);\n            tempFiles.push(finalVideoPath);\n            await new Promise((resolve, reject)=>{\n                fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_1___default()().input(videoPath).input(audioPath).outputOptions([\n                    \"-c:v copy\",\n                    \"-c:a aac\",\n                    \"-shortest\",\n                    \"-movflags faststart\"\n                ]).output(finalVideoPath).on(\"end\", resolve).on(\"error\", reject).run();\n            });\n            // Upload to S3\n            const videoData = await readFile(finalVideoPath);\n            const videoKey = `reels/${sanitizedName}-reel${reelIdx}-${timestamp}.mp4`;\n            await s3.send(new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n                Bucket: process.env.AWS_S3_BUCKET,\n                Key: videoKey,\n                Body: videoData,\n                ContentType: \"video/mp4\"\n            }));\n            reels.push({\n                id: `${sanitizedName}-reel${reelIdx}-${timestamp}`,\n                videoUrl: `${bucketEndpoint}/${videoKey}`,\n                celebrity,\n                script,\n                title: `${celebrity}'s Career Highlights`,\n                description: `${script.substring(0, 97)}${script.length > 97 ? \"...\" : \"\"}`\n            });\n        }\n        return res.status(200).json({\n            success: true,\n            reels\n        });\n    } catch (error) {\n        console.error(\"Video generation error:\", error);\n        return res.status(500).json({\n            error: \"Video generation failed\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        });\n    } finally{\n        // Cleanup temporary files\n        try {\n            await Promise.all(tempFiles.filter((filePath)=>filePath && fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(filePath)).map((filePath)=>unlink(filePath).catch((e)=>console.error(`Error deleting ${filePath}:`, e))));\n        } catch (cleanupError) {\n            console.error(\"Error during cleanup:\", cleanupError);\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_errorHandler__WEBPACK_IMPORTED_MODULE_6__.withErrorHandler)(handler));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL2dlbmVyYXRlLXZpZGVvLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ2dFO0FBQzdCO0FBQ2Y7QUFDSTtBQUNFO0FBQ087QUFDaUI7QUFFbEQsTUFBTVEsWUFBWUYsK0NBQVNBLENBQUNILHFEQUFZO0FBQ3hDLE1BQU1NLFdBQVdILCtDQUFTQSxDQUFDSCxvREFBVztBQUN0QyxNQUFNTyxTQUFTSiwrQ0FBU0EsQ0FBQ0gsa0RBQVM7QUFFbEMsTUFBTVEsS0FBSyxJQUFJWCx3REFBUUEsQ0FBQztJQUN0QlksUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxVQUFVO0lBQzlCQyxhQUFhO1FBQ1hDLGFBQWFKLFFBQVFDLEdBQUcsQ0FBQ0ksaUJBQWlCO1FBQzFDQyxpQkFBaUJOLFFBQVFDLEdBQUcsQ0FBQ00scUJBQXFCO0lBQ3BEO0FBQ0Y7QUFFQSxNQUFNQyxpQkFBaUIsQ0FBQyxRQUFRLEVBQUVSLFFBQVFDLEdBQUcsQ0FBQ1EsYUFBYSxDQUFDLElBQUksRUFBRVQsUUFBUUMsR0FBRyxDQUFDQyxVQUFVLENBQUMsY0FBYyxDQUFDO0FBRXhHLE1BQU1RLGlCQUF5QztJQUM3QyxnQkFBZ0I7SUFDaEIsaUJBQWlCO0lBQ2pCLGdCQUFnQjtBQUNsQjtBQUVPLE1BQU1DLFNBQVM7SUFDcEJDLEtBQUs7UUFDSEMsWUFBWTtZQUNWQyxXQUFXO1FBQ2I7SUFDRjtBQUNGLEVBQUU7QUFFRixNQUFNQyxjQUFjLEdBQUcsa0JBQWtCO0FBQ3pDLE1BQU1DLGFBQWEsR0FBSSw4QkFBOEI7QUFDckQsTUFBTUMsaUJBQWlCLEdBQUcsb0JBQW9CO0FBRTlDLGVBQWVDLDRCQUE0QkMsU0FBaUI7SUFDMUQsTUFBTUMsU0FBbUIsRUFBRTtJQUMzQixNQUFNQyxjQUFjTixjQUFjQztJQUVsQyxVQUFVO0lBQ1YsSUFBSU4sY0FBYyxDQUFDUyxVQUFVLEVBQUU7UUFDN0IsSUFBSTtZQUNGLE1BQU1HLFNBQVMsQ0FBQyxrREFBa0QsRUFB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UiwwQkFBMEI7UUFDMUIsSUFBSTtZQUNGLE1BQU0xQixRQUFRMkIsR0FBRyxDQUNmNUQsVUFDRzZELE1BQU0sQ0FBQyxDQUFDQyxXQUFhQSxZQUFZdkksb0RBQWEsQ0FBQ3VJLFdBQy9DaEMsR0FBRyxDQUFDLENBQUNnQyxXQUFhaEksT0FBT2dJLFVBQVVDLEtBQUssQ0FBQyxDQUFDQyxJQUFNUixRQUFRekQsS0FBSyxDQUFDLENBQUMsZUFBZSxFQUFFK0QsU0FBUyxDQUFDLENBQUMsRUFBRUU7UUFFcEcsRUFBRSxPQUFPQyxjQUFjO1lBQ3JCVCxRQUFRekQsS0FBSyxDQUFDLHlCQUF5QmtFO1FBQ3pDO0lBQ0Y7QUFDRjtBQUVBLGlFQUFldEksK0RBQWdCQSxDQUFDOEQsUUFBUUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Nwb3J0cy1yZWVscy8uL3NyYy9wYWdlcy9hcGkvZ2VuZXJhdGUtdmlkZW8udHM/MzZmMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XHJcbmltcG9ydCB7IFMzQ2xpZW50LCBQdXRPYmplY3RDb21tYW5kIH0gZnJvbSAnQGF3cy1zZGsvY2xpZW50LXMzJztcclxuaW1wb3J0IGZmbXBlZyBmcm9tICdmbHVlbnQtZmZtcGVnJztcclxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XHJcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gJ3V0aWwnO1xyXG5pbXBvcnQgeyB3aXRoRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi9lcnJvckhhbmRsZXInO1xyXG5cclxuY29uc3Qgd3JpdGVGaWxlID0gcHJvbWlzaWZ5KGZzLndyaXRlRmlsZSk7XHJcbmNvbnN0IHJlYWRGaWxlID0gcHJvbWlzaWZ5KGZzLnJlYWRGaWxlKTtcclxuY29uc3QgdW5saW5rID0gcHJvbWlzaWZ5KGZzLnVubGluayk7XHJcblxyXG5jb25zdCBzMyA9IG5ldyBTM0NsaWVudCh7XHJcbiAgcmVnaW9uOiBwcm9jZXNzLmVudi5BV1NfUkVHSU9OLFxyXG4gIGNyZWRlbnRpYWxzOiB7XHJcbiAgICBhY2Nlc3NLZXlJZDogcHJvY2Vzcy5lbnYuQVdTX0FDQ0VTU19LRVlfSUQhLFxyXG4gICAgc2VjcmV0QWNjZXNzS2V5OiBwcm9jZXNzLmVudi5BV1NfU0VDUkVUX0FDQ0VTU19LRVkhLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgYnVja2V0RW5kcG9pbnQgPSBgaHR0cHM6Ly8ke3Byb2Nlc3MuZW52LkFXU19TM19CVUNLRVR9LnMzLiR7cHJvY2Vzcy5lbnYuQVdTX1JFR0lPTn0uYW1hem9uYXdzLmNvbWA7XHJcblxyXG5jb25zdCBOQkFfUExBWUVSX0lEUzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHtcclxuICAnTGVCcm9uIEphbWVzJzogMjU0NCxcclxuICAnU3RlcGhlbiBDdXJyeSc6IDIwMTkzOSxcclxuICAnS2V2aW4gRHVyYW50JzogMjAxMTQyLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBhcGk6IHtcclxuICAgIGJvZHlQYXJzZXI6IHtcclxuICAgICAgc2l6ZUxpbWl0OiAnMjVtYicsXHJcbiAgICB9LFxyXG4gIH0sXHJcbn07XHJcblxyXG5jb25zdCBJTUFHRV9DT1VOVCA9IDU7IC8vIEltYWdlcyBwZXIgcmVlbFxyXG5jb25zdCBSRUVMX0NPVU5UID0gMjsgIC8vIE51bWJlciBvZiByZWVscyB0byBnZW5lcmF0ZVxyXG5jb25zdCBJTUFHRV9EVVJBVElPTiA9IDI7IC8vIHNlY29uZHMgcGVyIGltYWdlXHJcblxyXG5hc3luYyBmdW5jdGlvbiBkb3dubG9hZEltYWdlc1dpdGhGYWxsYmFja3MoY2VsZWJyaXR5OiBzdHJpbmcpOiBQcm9taXNlPEJ1ZmZlcltdPiB7XHJcbiAgY29uc3QgaW1hZ2VzOiBCdWZmZXJbXSA9IFtdO1xyXG4gIGNvbnN0IElNQUdFX1RPVEFMID0gSU1BR0VfQ09VTlQgKiBSRUVMX0NPVU5UO1xyXG5cclxuICAvLyBOQkEgQ0ROXHJcbiAgaWYgKE5CQV9QTEFZRVJfSURTW2NlbGVicml0eV0pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IG5iYVVybCA9IGBodHRwczovL2Nkbi5uYmEuY29tL2hlYWRzaG90cy9uYmEvbGF0ZXN0LzEwNDB4NzYwLyR7TkJBX1BMQVlFUl9JRFNbY2VsZWJyaXR5XX0ucG5nYDtcclxuICAgICAgY29uc3QgbmJhSW1nID0gYXdhaXQgYXhpb3MuZ2V0KG5iYVVybCwgeyByZXNwb25zZVR5cGU6ICdhcnJheWJ1ZmZlcicgfSk7XHJcbiAgICAgIGltYWdlcy5wdXNoKEJ1ZmZlci5mcm9tKG5iYUltZy5kYXRhLCAnYmluYXJ5JykpO1xyXG4gICAgfSBjYXRjaCB7fVxyXG4gIH1cclxuXHJcbiAgLy8gV2lraW1lZGlhIENvbW1vbnNcclxuICB0cnkge1xyXG4gICAgY29uc3Qgd2lraUFwaSA9IGBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvdy9hcGkucGhwP2FjdGlvbj1xdWVyeSZnZW5lcmF0b3I9aW1hZ2VzJnRpdGxlcz0ke2VuY29kZVVSSUNvbXBvbmVudChjZWxlYnJpdHkpfSZnaW1saW1pdD0xMCZwcm9wPWltYWdlaW5mbyZpaXByb3A9dXJsJmZvcm1hdD1qc29uYDtcclxuICAgIGNvbnN0IHdpa2lSZXNwID0gYXdhaXQgYXhpb3MuZ2V0KHdpa2lBcGkpO1xyXG4gICAgY29uc3QgcGFnZXMgPSB3aWtpUmVzcC5kYXRhPy5xdWVyeT8ucGFnZXMgfHwge307XHJcbiAgICBmb3IgKGNvbnN0IHBhZ2Ugb2YgT2JqZWN0LnZhbHVlcyhwYWdlcykpIHtcclxuICAgICAgY29uc3QgdXJsID0gKHBhZ2UgYXMgeyBpbWFnZWluZm8/OiB7IHVybD86IHN0cmluZyB9W10gfSkuaW1hZ2VpbmZvPy5bMF0/LnVybDtcclxuICAgICAgaWYgKHVybCAmJiAvXFwuKGpwZ3xqcGVnfHBuZykkL2kudGVzdCh1cmwpKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IGltZ1Jlc3AgPSBhd2FpdCBheGlvcy5nZXQodXJsLCB7IHJlc3BvbnNlVHlwZTogJ2FycmF5YnVmZmVyJyB9KTtcclxuICAgICAgICAgIGltYWdlcy5wdXNoKEJ1ZmZlci5mcm9tKGltZ1Jlc3AuZGF0YSwgJ2JpbmFyeScpKTtcclxuICAgICAgICAgIGlmIChpbWFnZXMubGVuZ3RoID49IElNQUdFX1RPVEFMKSBicmVhaztcclxuICAgICAgICB9IGNhdGNoIHt9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9IGNhdGNoIHt9XHJcblxyXG4gIC8vIFBleGVscyBBUElcclxuICBpZiAocHJvY2Vzcy5lbnYuUEVYRUxTX0FQSV9LRVkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHBleGVsc1VybCA9IGBodHRwczovL2FwaS5wZXhlbHMuY29tL3YxL3NlYXJjaD9xdWVyeT0ke2VuY29kZVVSSUNvbXBvbmVudChjZWxlYnJpdHkpfSZwZXJfcGFnZT0ke0lNQUdFX1RPVEFMfWA7XHJcbiAgICAgIGNvbnN0IHBleGVsc1Jlc3AgPSBhd2FpdCBheGlvcy5nZXQocGV4ZWxzVXJsLCB7XHJcbiAgICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBwcm9jZXNzLmVudi5QRVhFTFNfQVBJX0tFWSB9LFxyXG4gICAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nLFxyXG4gICAgICB9KTtcclxuICAgICAgaWYgKHBleGVsc1Jlc3AuZGF0YS5waG90b3M/Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHBob3RvIG9mIHBleGVsc1Jlc3AuZGF0YS5waG90b3MpIHtcclxuICAgICAgICAgIGNvbnN0IGltYWdlVXJsID0gcGhvdG8uc3JjLmxhcmdlMng7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBpbWdSZXNwID0gYXdhaXQgYXhpb3MuZ2V0KGltYWdlVXJsLCB7IHJlc3BvbnNlVHlwZTogJ2FycmF5YnVmZmVyJyB9KTtcclxuICAgICAgICAgICAgaW1hZ2VzLnB1c2goQnVmZmVyLmZyb20oaW1nUmVzcC5kYXRhLCAnYmluYXJ5JykpO1xyXG4gICAgICAgICAgICBpZiAoaW1hZ2VzLmxlbmd0aCA+PSBJTUFHRV9UT1RBTCkgYnJlYWs7XHJcbiAgICAgICAgICB9IGNhdGNoIHt9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIHt9XHJcbiAgfVxyXG5cclxuICAvLyBVbnNwbGFzaCBmYWxsYmFja1xyXG4gIGNvbnN0IGZhbGxiYWNrVXJscyA9IFtcclxuICAgICdodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU0NjUxOTYzOC02OGUxMDk0OThmZmM/aXhsaWI9cmItMS4yLjEmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz04MDAmaD0xNDAwJnE9ODAnLFxyXG4gICAgJ2h0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTE3NjQ5NzYzOTYyLTBjNjIzMDY2MDEzYj9peGxpYj1yYi0xLjIuMSZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTgwMCZxPTgwJyxcclxuICAgICdodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTQ2NDk4Mzk1MzU3NC0wODkyYTcxNjg1NGI/aXhsaWI9cmItMS4yLjEmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz04MDAmcT04MCcsXHJcbiAgICAnaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MDU4NDMyNzMxMzItYmM1YTk5MzYzNWM0P2l4bGliPXJiLTEuMi4xJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9ODAwJnE9ODAnLFxyXG4gICAgJ2h0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTE3NjQ5NzYzOTYyLTBjNjIzMDY2MDEzYj9peGxpYj1yYi0xLjIuMSZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTgwMCZxPTgwJ1xyXG4gIF07XHJcbiAgbGV0IGkgPSAwO1xyXG4gIHdoaWxlIChpbWFnZXMubGVuZ3RoIDwgSU1BR0VfVE9UQUwpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHVybCA9IGZhbGxiYWNrVXJsc1tpICUgZmFsbGJhY2tVcmxzLmxlbmd0aF07XHJcbiAgICAgIGNvbnN0IGltZ1Jlc3AgPSBhd2FpdCBheGlvcy5nZXQodXJsLCB7IHJlc3BvbnNlVHlwZTogJ2FycmF5YnVmZmVyJyB9KTtcclxuICAgICAgaW1hZ2VzLnB1c2goQnVmZmVyLmZyb20oaW1nUmVzcC5kYXRhLCAnYmluYXJ5JykpO1xyXG4gICAgfSBjYXRjaCB7fVxyXG4gICAgaSsrO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGltYWdlcy5zbGljZSgwLCBJTUFHRV9UT1RBTCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcclxuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCB0ZW1wRmlsZXM6IHN0cmluZ1tdID0gW107XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgYXVkaW9CdWZmZXIsIGNlbGVicml0eSwgc2NyaXB0IH0gPSByZXEuYm9keTtcclxuICAgIGlmICghYXVkaW9CdWZmZXIgfHwgIWNlbGVicml0eSB8fCAhc2NyaXB0KSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCBpbnB1dCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ29udmVydCBhdWRpbyBkYXRhIHRvIEJ1ZmZlclxyXG4gICAgbGV0IGF1ZGlvRGF0YTogQnVmZmVyO1xyXG4gICAgaWYgKHR5cGVvZiBhdWRpb0J1ZmZlciA9PT0gJ3N0cmluZycgJiYgYXVkaW9CdWZmZXIuc3RhcnRzV2l0aCgnZGF0YTonKSkge1xyXG4gICAgICBjb25zdCBiYXNlNjREYXRhID0gYXVkaW9CdWZmZXIuc3BsaXQoJ2Jhc2U2NCwnKVsxXTtcclxuICAgICAgaWYgKCFiYXNlNjREYXRhKSByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgQmFzZTY0IGF1ZGlvQnVmZmVyIGZvcm1hdCcgfSk7XHJcbiAgICAgIGF1ZGlvRGF0YSA9IEJ1ZmZlci5mcm9tKGJhc2U2NERhdGEsICdiYXNlNjQnKTtcclxuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShhdWRpb0J1ZmZlcikpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhdWRpb0RhdGEgPSBCdWZmZXIuZnJvbShuZXcgVWludDhBcnJheShhdWRpb0J1ZmZlcikpO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCBBcnJheUJ1ZmZlciBmb3JtYXQnIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgYXVkaW8gZm9ybWF0OiBtdXN0IGJlIEJhc2U2NCBvciBBcnJheUJ1ZmZlcicgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc2FuaXRpemVkTmFtZSA9IGNlbGVicml0eS5yZXBsYWNlKC9bXmEtejAtOV0vZ2ksICdfJykudG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IHRlbXBEaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3RtcCcpO1xyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHRlbXBEaXIpKSBmcy5ta2RpclN5bmModGVtcERpcik7XHJcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIC8vIERvd25sb2FkIGVub3VnaCBpbWFnZXMgZm9yIGFsbCByZWVsc1xyXG4gICAgY29uc3QgYWxsSW1hZ2VzID0gYXdhaXQgZG93bmxvYWRJbWFnZXNXaXRoRmFsbGJhY2tzKGNlbGVicml0eSk7XHJcblxyXG4gICAgY29uc3QgcmVlbHM6IGFueVtdID0gW107XHJcbiAgICBmb3IgKGxldCByZWVsSWR4ID0gMDsgcmVlbElkeCA8IFJFRUxfQ09VTlQ7IHJlZWxJZHgrKykge1xyXG4gICAgICAvLyBQaWNrIGEgZGlmZmVyZW50IHNsaWNlIG9mIGltYWdlcyBmb3IgZWFjaCByZWVsXHJcbiAgICAgIGNvbnN0IGltYWdlcyA9IGFsbEltYWdlcy5zbGljZShyZWVsSWR4ICogSU1BR0VfQ09VTlQsIChyZWVsSWR4ICsgMSkgKiBJTUFHRV9DT1VOVCk7XHJcbiAgICAgIHdoaWxlIChpbWFnZXMubGVuZ3RoIDwgSU1BR0VfQ09VTlQpIGltYWdlcy5wdXNoKGltYWdlc1tpbWFnZXMubGVuZ3RoIC0gMV0pO1xyXG5cclxuICAgICAgLy8gU2F2ZSBpbWFnZXNcclxuICAgICAgY29uc3QgaW1hZ2VQYXRoczogc3RyaW5nW10gPSBbXTtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbWFnZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBpbWdQYXRoID0gcGF0aC5qb2luKHRlbXBEaXIsIGAke3Nhbml0aXplZE5hbWV9LXJlZWwke3JlZWxJZHh9LWltZyR7aX0tJHt0aW1lc3RhbXB9LmpwZ2ApO1xyXG4gICAgICAgIGF3YWl0IHdyaXRlRmlsZShpbWdQYXRoLCBpbWFnZXNbaV0pO1xyXG4gICAgICAgIGltYWdlUGF0aHMucHVzaChpbWdQYXRoKTtcclxuICAgICAgICB0ZW1wRmlsZXMucHVzaChpbWdQYXRoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gU2F2ZSBhdWRpbyBmaWxlXHJcbiAgICAgIGNvbnN0IGF1ZGlvUGF0aCA9IHBhdGguam9pbih0ZW1wRGlyLCBgJHtzYW5pdGl6ZWROYW1lfS1yZWVsJHtyZWVsSWR4fS1hdWRpby0ke3RpbWVzdGFtcH0ubXAzYCk7XHJcbiAgICAgIGF3YWl0IHdyaXRlRmlsZShhdWRpb1BhdGgsIGF1ZGlvRGF0YSk7XHJcbiAgICAgIHRlbXBGaWxlcy5wdXNoKGF1ZGlvUGF0aCk7XHJcblxyXG4gICAgICAvLyBQcmVwYXJlIGZmbXBlZyBpbnB1dCBmaWxlIGxpc3QgZm9yIHNsaWRlc2hvd1xyXG4gICAgICBjb25zdCBmZm1wZWdMaXN0UGF0aCA9IHBhdGguam9pbih0ZW1wRGlyLCBgJHtzYW5pdGl6ZWROYW1lfS1yZWVsJHtyZWVsSWR4fS1mZm1wZWctbGlzdC0ke3RpbWVzdGFtcH0udHh0YCk7XHJcbiAgICAgIGNvbnN0IGZmbXBlZ0xpc3RDb250ZW50ID0gaW1hZ2VQYXRocy5tYXAoaW1nID0+IGBmaWxlICcke2ltZy5yZXBsYWNlKC9cXFxcL2csICcvJyl9J1xcbmR1cmF0aW9uICR7SU1BR0VfRFVSQVRJT059YCkuam9pbignXFxuJyk7XHJcbiAgICAgIGF3YWl0IHdyaXRlRmlsZShmZm1wZWdMaXN0UGF0aCwgZmZtcGVnTGlzdENvbnRlbnQgKyBgXFxuZmlsZSAnJHtpbWFnZVBhdGhzW2ltYWdlUGF0aHMubGVuZ3RoIC0gMV0ucmVwbGFjZSgvXFxcXC9nLCAnLycpfSdcXG5gKTtcclxuICAgICAgdGVtcEZpbGVzLnB1c2goZmZtcGVnTGlzdFBhdGgpO1xyXG5cclxuICAgICAgLy8gT3V0cHV0IHZpZGVvIHBhdGhcclxuICAgICAgY29uc3QgdmlkZW9QYXRoID0gcGF0aC5qb2luKHRlbXBEaXIsIGAke3Nhbml0aXplZE5hbWV9LXJlZWwke3JlZWxJZHh9LXZpZGVvLSR7dGltZXN0YW1wfS5tcDRgKTtcclxuICAgICAgdGVtcEZpbGVzLnB1c2godmlkZW9QYXRoKTtcclxuXHJcbiAgICAgIC8vIEdlbmVyYXRlIHNsaWRlc2hvdyB2aWRlbyBmcm9tIGltYWdlc1xyXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgZmZtcGVnKClcclxuICAgICAgICAgIC5pbnB1dChmZm1wZWdMaXN0UGF0aClcclxuICAgICAgICAgIC5pbnB1dE9wdGlvbnMoWyctZiBjb25jYXQnLCAnLXNhZmUgMCddKVxyXG4gICAgICAgICAgLm91dHB1dE9wdGlvbnMoW1xyXG4gICAgICAgICAgICAnLXZmIHNjYWxlPTcyMDoxMjgwLGZvcm1hdD15dXY0MjBwJyxcclxuICAgICAgICAgICAgJy1waXhfZm10IHl1djQyMHAnLFxyXG4gICAgICAgICAgICAnLXIgMzAnXHJcbiAgICAgICAgICBdKVxyXG4gICAgICAgICAgLm91dHB1dE9wdGlvbnMoJy15JylcclxuICAgICAgICAgIC5vdXRwdXQodmlkZW9QYXRoKVxyXG4gICAgICAgICAgLm9uKCdlbmQnLCByZXNvbHZlKVxyXG4gICAgICAgICAgLm9uKCdlcnJvcicsIHJlamVjdClcclxuICAgICAgICAgIC5ydW4oKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBNZXJnZSBhdWRpbyB3aXRoIHNsaWRlc2hvdyB2aWRlb1xyXG4gICAgICBjb25zdCBmaW5hbFZpZGVvUGF0aCA9IHBhdGguam9pbih0ZW1wRGlyLCBgJHtzYW5pdGl6ZWROYW1lfS1yZWVsJHtyZWVsSWR4fS1maW5hbC0ke3RpbWVzdGFtcH0ubXA0YCk7XHJcbiAgICAgIHRlbXBGaWxlcy5wdXNoKGZpbmFsVmlkZW9QYXRoKTtcclxuXHJcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBmZm1wZWcoKVxyXG4gICAgICAgICAgLmlucHV0KHZpZGVvUGF0aClcclxuICAgICAgICAgIC5pbnB1dChhdWRpb1BhdGgpXHJcbiAgICAgICAgICAub3V0cHV0T3B0aW9ucyhbXHJcbiAgICAgICAgICAgICctYzp2IGNvcHknLFxyXG4gICAgICAgICAgICAnLWM6YSBhYWMnLFxyXG4gICAgICAgICAgICAnLXNob3J0ZXN0JyxcclxuICAgICAgICAgICAgJy1tb3ZmbGFncyBmYXN0c3RhcnQnXHJcbiAgICAgICAgICBdKVxyXG4gICAgICAgICAgLm91dHB1dChmaW5hbFZpZGVvUGF0aClcclxuICAgICAgICAgIC5vbignZW5kJywgcmVzb2x2ZSlcclxuICAgICAgICAgIC5vbignZXJyb3InLCByZWplY3QpXHJcbiAgICAgICAgICAucnVuKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gVXBsb2FkIHRvIFMzXHJcbiAgICAgIGNvbnN0IHZpZGVvRGF0YSA9IGF3YWl0IHJlYWRGaWxlKGZpbmFsVmlkZW9QYXRoKTtcclxuICAgICAgY29uc3QgdmlkZW9LZXkgPSBgcmVlbHMvJHtzYW5pdGl6ZWROYW1lfS1yZWVsJHtyZWVsSWR4fS0ke3RpbWVzdGFtcH0ubXA0YDtcclxuXHJcbiAgICAgIGF3YWl0IHMzLnNlbmQoXHJcbiAgICAgICAgbmV3IFB1dE9iamVjdENvbW1hbmQoe1xyXG4gICAgICAgICAgQnVja2V0OiBwcm9jZXNzLmVudi5BV1NfUzNfQlVDS0VUISxcclxuICAgICAgICAgIEtleTogdmlkZW9LZXksXHJcbiAgICAgICAgICBCb2R5OiB2aWRlb0RhdGEsXHJcbiAgICAgICAgICBDb250ZW50VHlwZTogJ3ZpZGVvL21wNCcsXHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIHJlZWxzLnB1c2goe1xyXG4gICAgICAgIGlkOiBgJHtzYW5pdGl6ZWROYW1lfS1yZWVsJHtyZWVsSWR4fS0ke3RpbWVzdGFtcH1gLFxyXG4gICAgICAgIHZpZGVvVXJsOiBgJHtidWNrZXRFbmRwb2ludH0vJHt2aWRlb0tleX1gLFxyXG4gICAgICAgIGNlbGVicml0eSxcclxuICAgICAgICBzY3JpcHQsXHJcbiAgICAgICAgdGl0bGU6IGAke2NlbGVicml0eX0ncyBDYXJlZXIgSGlnaGxpZ2h0c2AsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IGAke3NjcmlwdC5zdWJzdHJpbmcoMCwgOTcpfSR7c2NyaXB0Lmxlbmd0aCA+IDk3ID8gJy4uLicgOiAnJ31gLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCByZWVscyB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignVmlkZW8gZ2VuZXJhdGlvbiBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBlcnJvcjogJ1ZpZGVvIGdlbmVyYXRpb24gZmFpbGVkJyxcclxuICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXHJcbiAgICB9KTtcclxuICB9IGZpbmFsbHkge1xyXG4gICAgLy8gQ2xlYW51cCB0ZW1wb3JhcnkgZmlsZXNcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgIHRlbXBGaWxlc1xyXG4gICAgICAgICAgLmZpbHRlcigoZmlsZVBhdGgpID0+IGZpbGVQYXRoICYmIGZzLmV4aXN0c1N5bmMoZmlsZVBhdGgpKVxyXG4gICAgICAgICAgLm1hcCgoZmlsZVBhdGgpID0+IHVubGluayhmaWxlUGF0aCkuY2F0Y2goKGUpID0+IGNvbnNvbGUuZXJyb3IoYEVycm9yIGRlbGV0aW5nICR7ZmlsZVBhdGh9OmAsIGUpKSlcclxuICAgICAgKTtcclxuICAgIH0gY2F0Y2ggKGNsZWFudXBFcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgY2xlYW51cDonLCBjbGVhbnVwRXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgd2l0aEVycm9ySGFuZGxlcihoYW5kbGVyKTsiXSwibmFtZXMiOlsiUzNDbGllbnQiLCJQdXRPYmplY3RDb21tYW5kIiwiZmZtcGVnIiwiZnMiLCJwYXRoIiwiYXhpb3MiLCJwcm9taXNpZnkiLCJ3aXRoRXJyb3JIYW5kbGVyIiwid3JpdGVGaWxlIiwicmVhZEZpbGUiLCJ1bmxpbmsiLCJzMyIsInJlZ2lvbiIsInByb2Nlc3MiLCJlbnYiLCJBV1NfUkVHSU9OIiwiY3JlZGVudGlhbHMiLCJhY2Nlc3NLZXlJZCIsIkFXU19BQ0NFU1NfS0VZX0lEIiwic2VjcmV0QWNjZXNzS2V5IiwiQVdTX1NFQ1JFVF9BQ0NFU1NfS0VZIiwiYnVja2V0RW5kcG9pbnQiLCJBV1NfUzNfQlVDS0VUIiwiTkJBX1BMQVlFUl9JRFMiLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwic2l6ZUxpbWl0IiwiSU1BR0VfQ09VTlQiLCJSRUVMX0NPVU5UIiwiSU1BR0VfRFVSQVRJT04iLCJkb3dubG9hZEltYWdlc1dpdGhGYWxsYmFja3MiLCJjZWxlYnJpdHkiLCJpbWFnZXMiLCJJTUFHRV9UT1RBTCIsIm5iYVVybCIsIm5iYUltZyIsImdldCIsInJlc3BvbnNlVHlwZSIsInB1c2giLCJCdWZmZXIiLCJmcm9tIiwiZGF0YSIsIndpa2lBcGkiLCJlbmNvZGVVUklDb21wb25lbnQiLCJ3aWtpUmVzcCIsInBhZ2VzIiwicXVlcnkiLCJwYWdlIiwiT2JqZWN0IiwidmFsdWVzIiwidXJsIiwiaW1hZ2VpbmZvIiwidGVzdCIsImltZ1Jlc3AiLCJsZW5ndGgiLCJQRVhFTFNfQVBJX0tFWSIsInBleGVsc1VybCIsInBleGVsc1Jlc3AiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsInBob3RvcyIsInBob3RvIiwiaW1hZ2VVcmwiLCJzcmMiLCJsYXJnZTJ4IiwiZmFsbGJhY2tVcmxzIiwiaSIsInNsaWNlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsInRlbXBGaWxlcyIsImF1ZGlvQnVmZmVyIiwic2NyaXB0IiwiYm9keSIsImF1ZGlvRGF0YSIsInN0YXJ0c1dpdGgiLCJiYXNlNjREYXRhIiwic3BsaXQiLCJBcnJheSIsImlzQXJyYXkiLCJVaW50OEFycmF5Iiwic2FuaXRpemVkTmFtZSIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsInRlbXBEaXIiLCJqb2luIiwiY3dkIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInRpbWVzdGFtcCIsIkRhdGUiLCJub3ciLCJhbGxJbWFnZXMiLCJyZWVscyIsInJlZWxJZHgiLCJpbWFnZVBhdGhzIiwiaW1nUGF0aCIsImF1ZGlvUGF0aCIsImZmbXBlZ0xpc3RQYXRoIiwiZmZtcGVnTGlzdENvbnRlbnQiLCJtYXAiLCJpbWciLCJ2aWRlb1BhdGgiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImlucHV0IiwiaW5wdXRPcHRpb25zIiwib3V0cHV0T3B0aW9ucyIsIm91dHB1dCIsIm9uIiwicnVuIiwiZmluYWxWaWRlb1BhdGgiLCJ2aWRlb0RhdGEiLCJ2aWRlb0tleSIsInNlbmQiLCJCdWNrZXQiLCJLZXkiLCJCb2R5IiwiQ29udGVudFR5cGUiLCJpZCIsInZpZGVvVXJsIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInN1YnN0cmluZyIsInN1Y2Nlc3MiLCJjb25zb2xlIiwiZGV0YWlscyIsIkVycm9yIiwibWVzc2FnZSIsImFsbCIsImZpbHRlciIsImZpbGVQYXRoIiwiY2F0Y2giLCJlIiwiY2xlYW51cEVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/generate-video.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-video&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cgenerate-video.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();